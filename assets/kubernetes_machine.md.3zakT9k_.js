import{_ as s,o as a,c as n,R as e}from"./chunks/framework.07BXFssY.js";const y=JSON.parse('{"title":"Machine","description":"","frontmatter":{},"headers":[],"relativePath":"kubernetes/machine.md","filePath":"kubernetes/machine.md","lastUpdated":1701909486000}'),p={name:"kubernetes/machine.md"},o=e(`<h1 id="machine" tabindex="-1">Machine <a class="header-anchor" href="#machine" aria-label="Permalink to &quot;Machine&quot;">​</a></h1><h2 id="alpine" tabindex="-1">Alpine <a class="header-anchor" href="#alpine" aria-label="Permalink to &quot;Alpine&quot;">​</a></h2><p>When open the alpine and see the login screen, just type <code>root</code> and press enter.</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki monokai vp-code"><code><span class="line"><span>setup-alpine</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-&gt; keyboard none</span></span>
<span class="line"><span>-&gt; hostname master1</span></span>
<span class="line"><span>-&gt; initialize interface eth0</span></span>
<span class="line"><span>-&gt; set dhcp</span></span>
<span class="line"><span>-&gt; manual network configuration no</span></span>
<span class="line"><span>-&gt; password toor</span></span>
<span class="line"><span>-&gt; timezone UTC</span></span>
<span class="line"><span>-&gt; no need proxy</span></span>
<span class="line"><span>-&gt; mirror select Triple Alkmar 9</span></span>
<span class="line"><span>-&gt; setup a user no</span></span>
<span class="line"><span>-&gt; openssh yes</span></span>
<span class="line"><span>-&gt; ssh prohibit-password</span></span>
<span class="line"><span>-&gt; sshkey URL to your public key, http://10.10.10.1:7080/id_rsa.pub</span></span>
<span class="line"><span>-&gt; select disk sda</span></span>
<span class="line"><span>-&gt; use sys</span></span>
<span class="line"><span>-&gt; erase disk yes</span></span></code></pre></div><p>Installation completed and reboot machine.</p><h3 id="install-packages" tabindex="-1">Install packages <a class="header-anchor" href="#install-packages" aria-label="Permalink to &quot;Install packages&quot;">​</a></h3><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki monokai vp-code"><code><span class="line"><span style="color:#A6E22E;">apk</span><span style="color:#E6DB74;"> update</span></span>
<span class="line"><span style="color:#A6E22E;">apk</span><span style="color:#E6DB74;"> add</span><span style="color:#E6DB74;"> bash</span><span style="color:#E6DB74;"> bash-completion</span><span style="color:#E6DB74;"> vim</span><span style="color:#E6DB74;"> curl</span><span style="color:#E6DB74;"> iproute2-ss</span><span style="color:#E6DB74;"> uuidgen</span></span></code></pre></div><p>Set bash as default shell in <code>/etc/passwd</code> file.</p><h3 id="clone-machine" tabindex="-1">Clone Machine <a class="header-anchor" href="#clone-machine" aria-label="Permalink to &quot;Clone Machine&quot;">​</a></h3><blockquote><p>Do that after adding all packages for kubernetes.</p></blockquote><p>Set machine as template and before to that close the machine.</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki monokai vp-code"><code><span class="line"><span style="color:#A6E22E;">poweroff</span></span></code></pre></div><p>Select as template and change name to node.</p><p>After that click to clone and set a name like <code>master1</code> or <code>worker1</code>.</p><p>Before to start the machine, change the mac address based on dhcpd config.</p><p>After to create new machine, set it as template for worker and reduce memory.</p><h3 id="set-hostname" tabindex="-1">Set Hostname <a class="header-anchor" href="#set-hostname" aria-label="Permalink to &quot;Set Hostname&quot;">​</a></h3><blockquote><p>TODO: configure hostname automatically with dhcp</p></blockquote><p>Add new hostname</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki monokai vp-code"><code><span class="line"><span style="color:#F8F8F2;">NODE_NAME</span><span style="color:#F92672;">=</span><span style="color:#E6DB74;">master2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;">echo</span><span style="color:#E6DB74;"> &quot;\${</span><span style="color:#F8F8F2;">NODE_NAME</span><span style="color:#E6DB74;">}&quot;</span><span style="color:#F92672;"> &gt;</span><span style="color:#E6DB74;"> /etc/hostname</span></span>
<span class="line"><span style="color:#A6E22E;">hostname</span><span style="color:#AE81FF;"> -F</span><span style="color:#E6DB74;"> /etc/hostname</span></span>
<span class="line"><span style="color:#A6E22E;">sed</span><span style="color:#AE81FF;"> -i</span><span style="color:#E6DB74;"> s@master1@</span><span style="color:#F8F8F2;">\${NODE_NAME}</span><span style="color:#E6DB74;">@g</span><span style="color:#E6DB74;"> /etc/hosts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6E22E;">uuidgen</span><span style="color:#F92672;"> &gt;</span><span style="color:#E6DB74;"> /etc/machine-id</span></span></code></pre></div>`,20),t=[o];function l(c,i,r,d,h,m){return a(),n("div",null,t)}const g=s(p,[["render",l]]);export{y as __pageData,g as default};
