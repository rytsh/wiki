<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Bucket Golang Concurrency | wiki</title>
    <meta name="description" content="rytsh's wiki">
    <meta name="generator" content="VitePress v1.2.3">
    <link rel="preload stylesheet" href="/wiki/assets/style.Bh1Z133X.css" as="style">
    
    <script type="module" src="/wiki/assets/app.C7SDvOe5.js"></script>
    <link rel="preload" href="/wiki/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/wiki/assets/chunks/framework.BEbjkBe4.js">
    <link rel="modulepreload" href="/wiki/assets/chunks/theme.D0G6eliy.js">
    <link rel="modulepreload" href="/wiki/assets/posts_bucket_go.md.kPHVKCp9.lean.js">
    <link rel="icon" href="/logo.png" type="image/png">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FGF7BPK5Z1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-FGF7BPK5Z1");</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-2e3296de><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0df68ce4></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0df68ce4> Skip to content </a><!--]--><!----><header class="VPNav" data-v-2e3296de data-v-3c516c77><div class="VPNavBar has-sidebar top" data-v-3c516c77 data-v-6e336b52><div class="wrapper" data-v-6e336b52><div class="container" data-v-6e336b52><div class="title" data-v-6e336b52><div class="VPNavBarTitle has-sidebar" data-v-6e336b52 data-v-4c327fd0><a class="title" href="/wiki/" data-v-4c327fd0><!--[--><!--]--><!----><span data-v-4c327fd0>wiki</span><!--[--><!--]--></a></div></div><div class="content" data-v-6e336b52><div class="content-body" data-v-6e336b52><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6e336b52><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6e336b52 data-v-0033e828><span id="main-nav-aria-label" class="visually-hidden" data-v-0033e828>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/wiki/" tabindex="0" data-v-0033e828 data-v-fa990b09><!--[--><span data-v-fa990b09>rytsh's wiki</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6e336b52 data-v-40b5f9c8><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-40b5f9c8 data-v-889b9dec data-v-fe6cb943><span class="check" data-v-fe6cb943><span class="icon" data-v-fe6cb943><!--[--><span class="vpi-sun sun" data-v-889b9dec></span><span class="vpi-moon moon" data-v-889b9dec></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6e336b52 data-v-26fb9ca6 data-v-4143b667><!--[--><a class="VPSocialLink no-icon" href="https://github.com/rytsh" aria-label="github" target="_blank" rel="noopener" data-v-4143b667 data-v-e50ea130><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6e336b52 data-v-4da50aac data-v-edb7443f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-edb7443f><span class="vpi-more-horizontal icon" data-v-edb7443f></span></button><div class="menu" data-v-edb7443f><div class="VPMenu" data-v-edb7443f data-v-09b4ee1f><!----><!--[--><!--[--><!----><div class="group" data-v-4da50aac><div class="item appearance" data-v-4da50aac><p class="label" data-v-4da50aac>Appearance</p><div class="appearance-action" data-v-4da50aac><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-4da50aac data-v-889b9dec data-v-fe6cb943><span class="check" data-v-fe6cb943><span class="icon" data-v-fe6cb943><!--[--><span class="vpi-sun sun" data-v-889b9dec></span><span class="vpi-moon moon" data-v-889b9dec></span><!--]--></span></span></button></div></div></div><div class="group" data-v-4da50aac><div class="item social-links" data-v-4da50aac><div class="VPSocialLinks social-links-list" data-v-4da50aac data-v-4143b667><!--[--><a class="VPSocialLink no-icon" href="https://github.com/rytsh" aria-label="github" target="_blank" rel="noopener" data-v-4143b667 data-v-e50ea130><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6e336b52 data-v-8ffcaac0><span class="container" data-v-8ffcaac0><span class="top" data-v-8ffcaac0></span><span class="middle" data-v-8ffcaac0></span><span class="bottom" data-v-8ffcaac0></span></span></button></div></div></div></div><div class="divider" data-v-6e336b52><div class="divider-line" data-v-6e336b52></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-2e3296de data-v-ec7a96fa><div class="container" data-v-ec7a96fa><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-ec7a96fa><span class="vpi-align-left menu-icon" data-v-ec7a96fa></span><span class="menu-text" data-v-ec7a96fa>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-ec7a96fa data-v-f3f17882><button data-v-f3f17882>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-2e3296de data-v-a96b324c><div class="curtain" data-v-a96b324c></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-a96b324c><span class="visually-hidden" id="sidebar-aria-label" data-v-a96b324c> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-a96b324c><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a96b324c data-v-b12df6ab><div class="item" role="button" tabindex="0" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><h2 class="text" data-v-b12df6ab>Tools</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b12df6ab><span class="vpi-chevron-right caret-icon" data-v-b12df6ab></span></div></div><div class="items" data-v-b12df6ab><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b12df6ab data-v-b12df6ab><div class="item" role="button" tabindex="0" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><h3 class="text" data-v-b12df6ab>Server</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b12df6ab><span class="vpi-chevron-right caret-icon" data-v-b12df6ab></span></div></div><div class="items" data-v-b12df6ab><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/tools/server/dhcpd.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>dhcpd</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/tools/server/tftp.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>tftp</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/tools/server/dns.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>dns</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/tools/server/load_balancer.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>load_balancer</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-a96b324c><section class="VPSidebarItem level-0 collapsible collapsed" data-v-a96b324c data-v-b12df6ab><div class="item" role="button" tabindex="0" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><h2 class="text" data-v-b12df6ab>Development</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b12df6ab><span class="vpi-chevron-right caret-icon" data-v-b12df6ab></span></div></div><div class="items" data-v-b12df6ab><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b12df6ab data-v-b12df6ab><div class="item" role="button" tabindex="0" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><h3 class="text" data-v-b12df6ab>Kubernetes</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b12df6ab><span class="vpi-chevron-right caret-icon" data-v-b12df6ab></span></div></div><div class="items" data-v-b12df6ab><!--[--><section class="VPSidebarItem level-2 collapsible collapsed" data-v-b12df6ab data-v-b12df6ab><div class="item" role="button" tabindex="0" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><h4 class="text" data-v-b12df6ab>Guide</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b12df6ab><span class="vpi-chevron-right caret-icon" data-v-b12df6ab></span></div></div><div class="items" data-v-b12df6ab><!--[--><div class="VPSidebarItem level-3 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/development/kubernetes/guide/kubeadm.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Kubeadm</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/development/kubernetes/guide/intro.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Intro</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/development/kubernetes/guide/core.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Core</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-2 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/development/kubernetes/qemu.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Qemu</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/development/kubernetes/vm.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>VM</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/development/kubernetes/management.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Management</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/development/kubernetes/machine.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Machine</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/development/kubernetes/install.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Install</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/development/kubernetes/network.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Network</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b12df6ab data-v-b12df6ab><div class="item" role="button" tabindex="0" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><h3 class="text" data-v-b12df6ab>Go</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b12df6ab><span class="vpi-chevron-right caret-icon" data-v-b12df6ab></span></div></div><div class="items" data-v-b12df6ab><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/development/go/generic_limit.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Generic Limit</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-b12df6ab data-v-b12df6ab><div class="item" role="button" tabindex="0" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><h3 class="text" data-v-b12df6ab>Rust</h3><!----></div><div class="items" data-v-b12df6ab><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/development/rust/intro.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Intro</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-a96b324c><section class="VPSidebarItem level-0 has-active" data-v-a96b324c data-v-b12df6ab><div class="item" role="button" tabindex="0" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><h2 class="text" data-v-b12df6ab>Posts</h2><!----></div><div class="items" data-v-b12df6ab><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/posts/fake_time.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Fake Time</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/posts/bucket_go.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Bucket Go</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/posts/git_changes.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Git Changes</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/posts/rebase_container.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Rebase Container</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/posts/nerd_fonts.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Nerd Fonts</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/posts/ssh_tunnel.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>SSH Tunnel</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/posts/github_actions.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Github Actions</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/posts/certificate.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Certificate</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/posts/port.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Port</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/posts/clipboard.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Clipboard</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/posts/git.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Git</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/posts/postgres_backup.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Postgres Backup</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/posts/terminal_view.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Terminal View</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b12df6ab data-v-b12df6ab><div class="item" data-v-b12df6ab><div class="indicator" data-v-b12df6ab></div><a class="VPLink link link" href="/wiki/posts/wsl.html" data-v-b12df6ab><!--[--><p class="text" data-v-b12df6ab>Wsl</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-2e3296de data-v-d6b0a259><div class="VPDoc has-sidebar has-aside" data-v-d6b0a259 data-v-914ced89><!--[--><!--]--><div class="container" data-v-914ced89><div class="aside" data-v-914ced89><div class="aside-curtain" data-v-914ced89></div><div class="aside-container" data-v-914ced89><div class="aside-content" data-v-914ced89><div class="VPDocAside" data-v-914ced89 data-v-d094951b><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-d094951b data-v-c472c6d7><div class="content" data-v-c472c6d7><div class="outline-marker" data-v-c472c6d7></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-c472c6d7>On this page</div><ul class="VPDocOutlineItem root" data-v-c472c6d7 data-v-e954ebc0><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-d094951b></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-914ced89><div class="content-container" data-v-914ced89><!--[--><!--]--><main class="main" data-v-914ced89><div style="position:relative;" class="vp-doc _wiki_posts_bucket_go" data-v-914ced89><div><h1 id="bucket-golang-concurrency" tabindex="-1">Bucket Golang Concurrency <a class="header-anchor" href="#bucket-golang-concurrency" aria-label="Permalink to &quot;Bucket Golang Concurrency&quot;">​</a></h1><p>When gets buch of data processing with goroutines, it&#39;s better to create buckets and them process them concurrently.</p><p>First we need to process count and minimal size of each bucket.</p><div class="language-go"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">var</span><span style="color:#EEFFFF;"> ProcessCount </span><span style="color:#C792EA;">int</span></span>
<span class="line"><span style="color:#89DDFF;">var</span><span style="color:#EEFFFF;"> BucketSize   </span><span style="color:#C792EA;">int</span></span></code></pre></div><p>Now our logic with using <code>errgroup</code> library in extended std library.</p><div class="language-go"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme vp-code" tabindex="0"><code><span class="line"><span style="color:#EEFFFF;">bucketSize </span><span style="color:#89DDFF;">:=</span><span style="color:#82AAFF;"> len</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">datas</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> /</span><span style="color:#EEFFFF;"> p</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">Count</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#EEFFFF;"> bucketSize </span><span style="color:#89DDFF;">&lt;</span><span style="color:#EEFFFF;"> p</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">MinBucketSize </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#EEFFFF;">    bucketSize </span><span style="color:#89DDFF;">=</span><span style="color:#EEFFFF;"> p</span><span style="color:#89DDFF;">.</span><span style="color:#EEFFFF;">MinBucketSize</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF;">g</span><span style="color:#89DDFF;">,</span><span style="color:#EEFFFF;"> ctx </span><span style="color:#89DDFF;">:=</span><span style="color:#EEFFFF;"> errgroup</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">WithContext</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">ctx</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#546E7A;font-style:italic;">// bucketing transactions and call it</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#EEFFFF;"> i </span><span style="color:#89DDFF;">:=</span><span style="color:#F78C6C;"> 0</span><span style="color:#89DDFF;">;</span><span style="color:#EEFFFF;"> i </span><span style="color:#89DDFF;">&lt;</span><span style="color:#82AAFF;"> len</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">datas</span><span style="color:#89DDFF;">);</span><span style="color:#EEFFFF;"> i </span><span style="color:#89DDFF;">+=</span><span style="color:#EEFFFF;"> bucketSize </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#EEFFFF;">    index </span><span style="color:#89DDFF;">:=</span><span style="color:#EEFFFF;"> i</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF;">    g</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Go</span><span style="color:#89DDFF;">(func()</span><span style="color:#C792EA;"> error</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">        return</span><span style="color:#82AAFF;"> process</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#EEFFFF;"> datas</span><span style="color:#89DDFF;">[</span><span style="color:#EEFFFF;">index</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;">min</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">index</span><span style="color:#89DDFF;">+</span><span style="color:#EEFFFF;">bucketSize</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> len</span><span style="color:#89DDFF;">(</span><span style="color:#EEFFFF;">datas</span><span style="color:#89DDFF;">))])</span></span>
<span class="line"><span style="color:#89DDFF;">    })</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#EEFFFF;"> g</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Wait</span><span style="color:#89DDFF;">()</span></span></code></pre></div><p><code>Wait</code> method will wait until all goroutines are done. If any of them returns an error, it will return that first error after cancel the context and wait for all goroutines to finish.</p></div></div></main><footer class="VPDocFooter" data-v-914ced89 data-v-43603688><!--[--><!--]--><div class="edit-info" data-v-43603688><div class="edit-link" data-v-43603688><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/rytsh/wiki/edit/main/posts/bucket_go.md" target="_blank" rel="noreferrer" data-v-43603688><!--[--><span class="vpi-square-pen edit-link-icon" data-v-43603688></span> Edit this page<!--]--></a></div><div class="last-updated" data-v-43603688><p class="VPLastUpdated" data-v-43603688 data-v-df7446aa>Updated at: <time datetime="2024-07-07T09:02:33.000Z" data-v-df7446aa></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-43603688><span class="visually-hidden" id="doc-footer-aria-label" data-v-43603688>Pager</span><div class="pager" data-v-43603688><a class="VPLink link pager-link prev" href="/wiki/posts/fake_time.html" data-v-43603688><!--[--><span class="desc" data-v-43603688>Previous page</span><span class="title" data-v-43603688>Fake Time</span><!--]--></a></div><div class="pager" data-v-43603688><a class="VPLink link pager-link next" href="/wiki/posts/git_changes.html" data-v-43603688><!--[--><span class="desc" data-v-43603688>Next page</span><span class="title" data-v-43603688>Git Changes</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"posts_ssh_tunnel.md\":\"BVj9T9-D\",\"development_rust_intro.md\":\"D9p7p54V\",\"index.md\":\"CMw2Aq3b\",\"posts_clipboard.md\":\"bL2uka90\",\"posts_nerd_fonts.md\":\"wB1As8Ai\",\"posts_github_actions.md\":\"CfuxkiYq\",\"posts_postgres_backup.md\":\"ClBGvraN\",\"development_go_generic_limit.md\":\"CGawjGBl\",\"development_kubernetes_guide_kubeadm.md\":\"DOew1LFH\",\"posts_git_changes.md\":\"CdMRa66l\",\"development_kubernetes_qemu.md\":\"BsBdLXQA\",\"development_kubernetes_guide_intro.md\":\"BF_2f2hz\",\"development_kubernetes_install.md\":\"BH7kz4eg\",\"development_kubernetes_management.md\":\"e3h6-3k1\",\"tools_server_dhcpd.md\":\"BN99vcA2\",\"development_kubernetes_vm.md\":\"BiUsLJZs\",\"posts_wsl.md\":\"CamV4yvS\",\"development_kubernetes_network.md\":\"B6xcOzbR\",\"posts_terminal_view.md\":\"D82TpwAd\",\"development_kubernetes_machine.md\":\"Co0wSj1S\",\"posts_rebase_container.md\":\"BtEzvLM1\",\"readme.md\":\"t2PKt06q\",\"posts_port.md\":\"DpzE3zS6\",\"posts_bucket_go.md\":\"kPHVKCp9\",\"tools_server_dns.md\":\"B8q5RcVh\",\"posts_git.md\":\"Bvg6VkM9\",\"posts_certificate.md\":\"D_dC47FT\",\"posts_fake_time.md\":\"tBy2ABDF\",\"development_kubernetes_guide_core.md\":\"BWaWtgtH\",\"tools_server_tftp.md\":\"B_NxdiVY\",\"tools_server_load_balancer.md\":\"BryEeIwq\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"wiki\",\"description\":\"rytsh's wiki\",\"base\":\"/wiki/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"rytsh's wiki\",\"link\":\"/\"}],\"sidebar\":[{\"text\":\"Tools\",\"items\":[{\"text\":\"Server\",\"items\":[{\"text\":\"dhcpd\",\"link\":\"/tools/server/dhcpd\"},{\"text\":\"tftp\",\"link\":\"/tools/server/tftp\"},{\"text\":\"dns\",\"link\":\"/tools/server/dns\"},{\"text\":\"load_balancer\",\"link\":\"/tools/server/load_balancer\"}],\"collapsed\":true}],\"collapsed\":true},{\"text\":\"Development\",\"items\":[{\"text\":\"Kubernetes\",\"items\":[{\"text\":\"Guide\",\"items\":[{\"text\":\"Kubeadm\",\"link\":\"/development/kubernetes/guide/kubeadm\"},{\"text\":\"Intro\",\"link\":\"/development/kubernetes/guide/intro\"},{\"text\":\"Core\",\"link\":\"/development/kubernetes/guide/core\"}],\"collapsed\":true},{\"text\":\"Qemu\",\"link\":\"/development/kubernetes/qemu\"},{\"text\":\"VM\",\"link\":\"/development/kubernetes/vm\"},{\"text\":\"Management\",\"link\":\"/development/kubernetes/management\"},{\"text\":\"Machine\",\"link\":\"/development/kubernetes/machine\"},{\"text\":\"Install\",\"link\":\"/development/kubernetes/install\"},{\"text\":\"Network\",\"link\":\"/development/kubernetes/network\"}],\"collapsed\":true},{\"text\":\"Go\",\"items\":[{\"text\":\"Generic Limit\",\"link\":\"/development/go/generic_limit\"}],\"collapsed\":true},{\"text\":\"Rust\",\"items\":[{\"text\":\"Intro\",\"link\":\"/development/rust/intro\"}]}],\"collapsed\":true},{\"text\":\"Posts\",\"items\":[{\"text\":\"Fake Time\",\"link\":\"/posts/fake_time\"},{\"text\":\"Bucket Go\",\"link\":\"/posts/bucket_go\"},{\"text\":\"Git Changes\",\"link\":\"/posts/git_changes\"},{\"text\":\"Rebase Container\",\"link\":\"/posts/rebase_container\"},{\"text\":\"Nerd Fonts\",\"link\":\"/posts/nerd_fonts\"},{\"text\":\"SSH Tunnel\",\"link\":\"/posts/ssh_tunnel\"},{\"text\":\"Github Actions\",\"link\":\"/posts/github_actions\"},{\"text\":\"Certificate\",\"link\":\"/posts/certificate\"},{\"text\":\"Port\",\"link\":\"/posts/port\"},{\"text\":\"Clipboard\",\"link\":\"/posts/clipboard\"},{\"text\":\"Git\",\"link\":\"/posts/git\"},{\"text\":\"Postgres Backup\",\"link\":\"/posts/postgres_backup\"},{\"text\":\"Terminal View\",\"link\":\"/posts/terminal_view\"},{\"text\":\"Wsl\",\"link\":\"/posts/wsl\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/rytsh\"}],\"editLink\":{\"pattern\":\"https://github.com/rytsh/wiki/edit/main/:path\"},\"search\":{\"provider\":\"local\"},\"lastUpdated\":{\"text\":\"Updated at\",\"formatOptions\":{\"dateStyle\":\"full\",\"timeStyle\":\"short\"}}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>